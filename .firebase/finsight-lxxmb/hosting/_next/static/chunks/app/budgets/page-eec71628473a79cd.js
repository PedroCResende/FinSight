(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[927],{2160:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},11133:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},13768:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]])},15638:(e,t,a)=>{Promise.resolve().then(a.bind(a,43809))},18186:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},19689:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]])},25318:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},28274:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]])},28328:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},31550:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},34301:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},42625:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},43809:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var s=a(95155),r=a(12115),i=a(17380),l=a(30285),n=a(54165),d=a(62523),c=a(85057),o=a(59409),h=a(66695),m=a(34301),u=a(75943),x=a(77223),y=a(78039),p=a(84713),g=a(19164),j=a(74641),v=a(24944),f=a(55365),k=a(77724),N=a(11133),w=a(50172),A=a(34477);let M=(0,A.createServerReference)("406b0a647173629c0a3c39990117762005d8a8a6d1",A.callServer,void 0,A.findSourceMapURL,"predictSpending");var b=a(90540);function C(e){let{budget:t,category:a,transactions:i=[]}=e,[d,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(null),[u,x]=(0,r.useState)(!1),[y,g]=(0,r.useState)(null);if(!t||!a)return null;let{limit:j,current:A}=t,C=j>0?A/j*100:0,S=Math.min(C,100),D=e=>e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),L=async()=>{c(!0),x(!0),g(null),m(null);try{let e=await M({transactions:i.map(e=>({...e,amount:Math.abs(e.amount)})),budgetLimit:t.limit,categoryName:a.name,currentDate:(0,p.GP)(new Date,"yyyy-MM-dd"),monthName:(0,p.GP)(new Date,"MMMM",{locale:b.F})});m(e)}catch(e){console.error("Error fetching predictive analysis:",e),g("N\xe3o foi poss\xedvel obter a an\xe1lise. Tente novamente mais tarde.")}finally{x(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h.Zp,{children:[(0,s.jsx)(h.aR,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(h.ZB,{className:"text-lg flex items-center gap-2",children:[a.icon&&(0,s.jsx)(a.icon,{className:"h-5 w-5",style:{color:a.color}}),a.name]}),(0,s.jsxs)(h.BT,{children:[D(A)," / ",D(j)]})]}),(0,s.jsx)(l.$,{variant:"ghost",size:"icon",onClick:L,title:"An\xe1lise Preditiva de Gastos",children:(0,s.jsx)(k.A,{className:"h-5 w-5 text-primary"})})]})}),(0,s.jsxs)(h.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.k,{value:S,indicatorClassName:C>90?"bg-red-500":C>70?"bg-yellow-500":"bg-green-500"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground text-right",children:[Math.round(C),"% Gasto"]})]}),C>100&&(0,s.jsxs)(f.Fc,{variant:"destructive",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)(f.XL,{children:"Limite Ultrapassado!"}),(0,s.jsxs)(f.TN,{children:["Voc\xea ultrapassou o limite em ",D(A-j),"."]})]}),C>=80&&C<=100&&(0,s.jsxs)(f.Fc,{className:"border-yellow-500 text-yellow-700 dark:border-yellow-600 dark:text-yellow-400 [&>svg]:text-yellow-600",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)(f.XL,{children:"Aten\xe7\xe3o"}),(0,s.jsxs)(f.TN,{children:["Voc\xea j\xe1 usou ",Math.round(C),"% do seu or\xe7amento."]})]})]})]}),(0,s.jsx)(n.lG,{open:d,onOpenChange:c,children:(0,s.jsxs)(n.Cf,{children:[(0,s.jsxs)(n.c7,{children:[(0,s.jsxs)(n.L3,{className:"flex items-center gap-2",children:[(0,s.jsx)(k.A,{className:"h-5 w-5 text-primary"}),"An\xe1lise Preditiva: ",a.name]}),(0,s.jsx)(n.rr,{children:"Nossa IA analisou seus gastos neste m\xeas para prever o resultado final."})]}),(0,s.jsxs)("div",{className:"py-4 space-y-4",children:[u&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[(0,s.jsx)(w.A,{className:"h-5 w-5 animate-spin"}),(0,s.jsx)("span",{children:"Analisando seus h\xe1bitos de consumo..."})]}),y&&(0,s.jsx)("p",{className:"text-destructive text-center",children:y}),o&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(f.Fc,{variant:o.isOnTrack?"default":"destructive",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)(f.XL,{children:o.isOnTrack?"Tudo sob controle!":"Alerta de Ritmo!"}),(0,s.jsx)(f.TN,{children:o.prediction})]}),(0,s.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,s.jsx)("p",{className:"font-semibold text-sm mb-2",children:"Recomenda\xe7\xe3o da IA:"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:o.insight})]})]})]})]})})]})}var S=a(87481),D=a(27600),L=a(24355),I=a(98383),P=a(2438);function B(){let{user:e}=(0,D.A)(),{toast:t}=(0,S.dj)(),{checkAndUnlockAchievement:a}=(0,P.k)(),[v,f]=(0,r.useState)([]),[k,N]=(0,r.useState)([]),[w,A]=(0,r.useState)([]),[M,b]=(0,r.useState)(!1),[B,O]=(0,r.useState)(null),[z,T]=(0,r.useState)(""),[E,G]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(async()=>{let[t,a,s]=await Promise.all([(0,L.BH)(e.uid),(0,L.bW)(e.uid),(0,L.I0)(e.uid)]);N(a.map(e=>({...e,icon:(0,I.AI)(e.icon)}))),f(t),A(s)})()},[e]),(0,r.useEffect)(()=>{var t;if(!e||0===v.length||0===w.length)return;let s=(t=new Date,(0,y.P)(t,-1)),r=(0,p.GP)(s,"yyyy-MM"),i=(0,g.w)(s),l=(0,j.p)(s),n=new Date;(0,p.GP)(n,"yyyy-MM");let d=(0,g.w)(n),c=(0,j.p)(n);v.forEach(e=>{let t=w.filter(t=>t.categoryId===e.categoryId&&new Date(t.date)>=i&&new Date(t.date)<=l&&t.amount<0).reduce((e,t)=>e+Math.abs(t.amount),0),s=w.filter(t=>t.categoryId===e.categoryId&&new Date(t.date)>=d&&new Date(t.date)<=c&&t.amount<0).reduce((e,t)=>e+Math.abs(t.amount),0);t>0&&s<.85*t&&a("reducedCategorySpendingBy15Percent")});let o=v.filter(e=>e.month===r);if(o.length>0&&o.every(e=>w.filter(t=>t.categoryId===e.categoryId&&new Date(t.date)>=i&&new Date(t.date)<=l&&t.amount<0).reduce((e,t)=>e+Math.abs(t.amount),0)<=e.limit)&&a("spentUnderBudget"),o.length>0){let e=o.reduce((e,t)=>e+t.limit,0),t=w.filter(e=>new Date(e.date)>=i&&new Date(e.date)<=l&&e.amount<0&&o.some(t=>t.categoryId===e.categoryId)).reduce((e,t)=>e+Math.abs(t.amount),0);e>0&&t<=.8*e&&a("spent20PercentUnderBudget")}},[v,w,e,a]);let R=(0,r.useMemo)(()=>{let e=(0,p.GP)(new Date,"yyyy-MM");return v.filter(t=>t.month===e)},[v]),F=(0,r.useMemo)(()=>{let e=(0,g.w)(new Date),t=(0,j.p)(new Date);return w.filter(a=>{let s=new Date(a.date.replace(/-/g,"/"));return s>=e&&s<=t})},[w]),H=e=>{var t;return(null==(t=k.find(t=>t.id===e))?void 0:t.name)||"Desconhecida"},Z=e=>{O(e),T(String(e.limit)),G(e.categoryId),b(!0)},$=async a=>{if(e)try{await (0,L.NN)(e.uid,a),f(v.filter(e=>e.id!==a)),t({title:"Sucesso",description:"Or\xe7amento deletado."})}catch(e){t({variant:"destructive",title:"Erro ao deletar",description:"N\xe3o foi poss\xedvel deletar o or\xe7amento."})}},U=async()=>{if(!e||!z||!E)return;let s=parseFloat(z);if(isNaN(s)||s<=0)return void t({variant:"destructive",title:"Valor Inv\xe1lido",description:"Por favor, insira um limite v\xe1lido."});try{if(null==B?void 0:B.id){let a={limit:s};await (0,L.rr)(e.uid,B.id,a),f(v.map(e=>e.id===B.id?{...e,...a}:e)),t({title:"Sucesso",description:"Or\xe7amento atualizado."})}else{let r={categoryId:E,limit:s,current:0,month:(0,p.GP)(new Date,"yyyy-MM")},i=await (0,L.XH)(e.uid,r);f([...v,{id:i,...r}]),a("firstBudgetCreated"),t({title:"Sucesso",description:"Or\xe7amento criado."})}b(!1)}catch(e){t({variant:"destructive",title:"Erro ao Salvar",description:"Ocorreu um erro ao salvar o or\xe7amento."})}},V=e=>e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});return(0,s.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-background",children:[(0,s.jsx)(i.Y,{}),(0,s.jsxs)("main",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsxs)(h.Zp,{children:[(0,s.jsxs)(h.aR,{children:[(0,s.jsx)(h.ZB,{children:"Or\xe7amentos do M\xeas"}),(0,s.jsxs)(h.BT,{children:["Acompanhe seus limites de gastos para o m\xeas ",(0,s.jsx)("span",{className:"font-bold text-primary",children:"ATUAL"}),"."]})]}),(0,s.jsx)(h.Wu,{children:R.length>0?(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:R.map(e=>{let t=F.filter(t=>t.categoryId===e.categoryId&&t.amount<0);return(0,s.jsx)(C,{budget:e,category:k.find(t=>t.id===e.categoryId),transactions:t},e.id)})}):(0,s.jsx)("p",{className:"text-center text-muted-foreground",children:"Nenhum or\xe7amento definido para este m\xeas. Crie um abaixo."})})]}),(0,s.jsxs)(h.Zp,{children:[(0,s.jsx)(h.aR,{children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h.ZB,{children:"Gerenciar Or\xe7amentos"}),(0,s.jsx)(h.BT,{children:"Crie e gerencie seus or\xe7amentos mensais por categoria."})]}),(0,s.jsxs)(l.$,{onClick:()=>{O({}),T(""),G(""),b(!0)},className:"w-full sm:w-auto",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Adicionar Or\xe7amento"]})]})}),(0,s.jsx)(h.Wu,{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)("div",{className:"divide-y divide-border",children:[v.map(e=>(0,s.jsxs)("div",{className:"flex items-center p-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium",children:H(e.categoryId)}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Limite: ",V(e.limit)," / m\xeas (",e.month,")"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>Z(e),children:(0,s.jsx)(u.A,{className:"h-4 w-4"})}),(0,s.jsx)(l.$,{variant:"ghost",size:"icon",onClick:()=>$(e.id),children:(0,s.jsx)(x.A,{className:"h-4 w-4 text-destructive"})})]})]},e.id)),0===v.length&&(0,s.jsx)("p",{className:"p-4 text-center text-muted-foreground",children:"Nenhum or\xe7amento encontrado."})]})})})]})]}),(0,s.jsx)(n.lG,{open:M,onOpenChange:b,children:(0,s.jsxs)(n.Cf,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(n.c7,{children:[(0,s.jsx)(n.L3,{children:(null==B?void 0:B.id)?"Editar Or\xe7amento":"Adicionar Or\xe7amento"}),(0,s.jsx)(n.rr,{children:(null==B?void 0:B.id)?"Atualize o limite para esta categoria.":"Defina um novo limite de gastos para uma categoria."})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(c.J,{htmlFor:"category",className:"text-right",children:"Categoria"}),(0,s.jsxs)(o.l6,{value:E,onValueChange:G,disabled:!!(null==B?void 0:B.id),children:[(0,s.jsx)(o.bq,{className:"col-span-3",children:(0,s.jsx)(o.yv,{placeholder:"Selecione uma categoria"})}),(0,s.jsx)(o.gC,{children:k.map(e=>(0,s.jsx)(o.eb,{value:e.id,disabled:v.some(t=>t.categoryId===e.id&&t.id!==(null==B?void 0:B.id)),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(c.J,{htmlFor:"limit",className:"text-right",children:"Limite (R$)"}),(0,s.jsx)(d.p,{id:"limit",type:"number",value:z,onChange:e=>T(e.target.value),className:"col-span-3",placeholder:"Ex: 500.00"})]})]}),(0,s.jsxs)(n.Es,{children:[(0,s.jsx)(l.$,{variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),(0,s.jsx)(l.$,{onClick:U,children:"Salvar"})]})]})})]})}},50172:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},58260:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]])},75943:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},77070:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},78039:(e,t,a)=>{"use strict";a.d(t,{P:()=>i});var s=a(35476),r=a(92084);function i(e,t){let a=(0,s.a)(e);if(isNaN(t))return(0,r.w)(e,NaN);if(!t)return a;let i=a.getDate(),l=(0,r.w)(e,a.getTime());return(l.setMonth(a.getMonth()+t+1,0),i>=l.getDate())?l:(a.setFullYear(l.getFullYear(),l.getMonth(),i),a)}},99274:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,522,918,111,307,587,122,751,630,269,441,684,358],()=>t(15638)),_N_E=e.O()}]);